(()=>{"use strict";var __webpack_modules__={527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocTreeProvider=void 0;const o=r(496),n=r(496),a=r(588);t.DocTreeProvider=class{getTreeItem(e){return e}getChildren(e){return e?Promise.resolve(e.children):Promise.resolve(this.getStructInConfig(a.default.getConfigPath()))}getStructInConfig(e){let t=a.default.extractDefaultThemeConfigFromFile(e),r=[];return r.push(new s("主菜单","结构",o.TreeItemCollapsibleState.Collapsed,this.analysisMenu(t.navbar),n.ThemeIcon.Folder)),r.push(new s("文档章节","结构",o.TreeItemCollapsibleState.Collapsed,this.analysisStruct(t.sidebar),n.ThemeIcon.Folder)),r}analysisMenu(e){let t=[];for(let r in e)t.push(new s(e[r].text,"菜单",o.TreeItemCollapsibleState.None,[],n.ThemeIcon.Folder));return t}analysisStruct(e){let t=[];for(let r in e)if(e[r].children)t.push(new s(e[r].text,"节点",o.TreeItemCollapsibleState.Collapsed,this.analysisStruct(e[r].children),n.ThemeIcon.Folder));else{if("string"!=typeof e[r])continue;t.push(new s(a.default.extractContent(e[r]),"文档",o.TreeItemCollapsibleState.None,[],n.ThemeIcon.File))}return t}};class s extends o.TreeItem{constructor(e,t,r,o,a=n.ThemeIcon.File){super(e,r),this.label=e,this.type=t,this.collapsibleState=r,this.children=o,this.iconPath=a,this.tooltip=`${this.label}-${this.type}`,this.description=this.type}}},588:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const fs=__webpack_require__(147),path=__webpack_require__(17),vscode_1=__webpack_require__(496);function extractDefaultThemeConfigFromFile(filePath){const fileContent=fs.readFileSync(filePath,"utf-8"),defaultThemeMatch=fileContent.match(/defaultTheme\(([\s\S]*?)\)/);if(defaultThemeMatch&&defaultThemeMatch.length>1){const defaultThemeConfigString=defaultThemeMatch[1];try{const defaultThemeConfig=eval(`(${defaultThemeConfigString})`);return defaultThemeConfig}catch(e){console.error("Failed to parse defaultTheme config:",e)}}return null}function extractContent(e){const t=e.split("/");let r="";return r=e.endsWith("/")?t[t.length-2]:e.endsWith(".md")?t[t.length-1].split(".md")[0]:t[t.length-1],r}function getCurrentDateTime(){const e=new Date,t=e.getFullYear().toString().slice(-2),r=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}${r}${t}${e.getHours().toString().padStart(2,"0")}${e.getMinutes().toString().padStart(2,"0")}${e.getSeconds().toString().padStart(2,"0")}`}function ensureDirectoryExists(e){fs.existsSync(e)||(fs.mkdirSync(e,{recursive:!0}),console.log("【INFO】在 ",e," 创建目录"))}function getCurrentDocumentRelativePath(){const e=vscode_1.window.activeTextEditor;if(e){const t=e.document;if(t){const e=vscode_1.workspace.rootPath;if(e)return path.parse(path.relative(path.join(e,"/docs/section/"),t.fileName)).dir}}}function insertTextAtCursorPosition(e){const t=vscode_1.window.activeTextEditor;if(t){const r=t.selection.active;return t.edit((t=>{t.insert(r,e)})).then((e=>e))}return Promise.resolve(!1)}function executeNpmScript(e){const t=new vscode_1.Task({type:"npm",script:e},vscode_1.TaskScope.Workspace,e,"npm",new vscode_1.ShellExecution(`npm run ${e}`));vscode_1.tasks.executeTask(t)}function executeScript(e){const t=new vscode_1.Task({type:"vuepress",script:e},vscode_1.TaskScope.Workspace,"vuepress","vuepress",new vscode_1.ShellExecution(e));vscode_1.tasks.executeTask(t)}function createStatusBarItem(){const e=vscode_1.window.createStatusBarItem(vscode_1.StatusBarAlignment.Left);e.text="$(file-code) My Panel",e.show()}function getConfigPath(){const e=vscode_1.workspace.workspaceFolders;return path.join(e[0].uri.fsPath,"docs/.vuepress/config.js")}function getImgFolderPath(){const e=vscode_1.workspace.workspaceFolders;return path.join(e[0].uri.fsPath,"docs/.vuepress/public/imgs/")}exports.default={extractDefaultThemeConfigFromFile,extractContent,createStatusBarItem,executeScript,executeNpmScript,insertTextAtCursorPosition,getCurrentDocumentRelativePath,ensureDirectoryExists,getCurrentDateTime,getConfigPath,getImgFolderPath}},529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.activate=void 0;const o=r(496),n=r(147),a=r(17),s=r(588);t.activate=function(e){e.subscriptions.push(o.commands.registerCommand("markdown.extension.vp.insertImg",(()=>{o.window.showOpenDialog({title:"选择要插入的图片文件",openLabel:"插入此图片",canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!0}).then((e=>{if(null==e)return;o.workspace.workspaceFolders;const t=o.window.activeTextEditor;let r="",i="",c="";if(!t)return void console.log("【ERROR】无法获取当前打开的文档！");let l=t.document,u="";if(l){{const e=a.basename(l.fileName);u=a.parse(e).name}r=u+"_"+s.default.getCurrentDateTime(),c=a.parse(e[0].path).ext,i=a.join(s.default.getImgFolderPath(),s.default.getCurrentDocumentRelativePath()),s.default.ensureDirectoryExists(i),n.copyFile(e[0].path,a.join(i,r+c),(e=>{e?console.error("【ERROR】权限或目录异常，无法复制文件",e):s.default.insertTextAtCursorPosition("<img :src=\"$withBase('/imgs/"+s.default.getCurrentDocumentRelativePath()+"/"+r+c+"')\" />")}))}else console.log("【ERROR】无法获取当前打开的文档！")}))})),o.commands.registerCommand("markdown.extension.vp.workstart",(()=>{s.default.executeNpmScript("start")})))}},496:e=>{e.exports=require("vscode")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}var __webpack_exports__={};(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=__webpack_require__(496),r=__webpack_require__(529),o=__webpack_require__(527);e.activate=function(e){t.window.createTreeView("nodeDependencies",{treeDataProvider:new o.DocTreeProvider}),function(e){r.activate(e),t.languages.setLanguageConfiguration("markdown",{wordPattern:/([*_]{1,2}|~~|`+)?[\p{Alphabetic}\p{Number}\p{Nonspacing_Mark}]+(_+[\p{Alphabetic}\p{Number}\p{Nonspacing_Mark}]+)*\1/gu})}(e)},e.deactivate=function(){}})(),module.exports=__webpack_exports__})();
//# sourceMappingURL=main.js.map