(()=>{"use strict";var __webpack_modules__={527:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocTreeProvider=void 0;const r=o(496),n=o(496),a=o(588);t.DocTreeProvider=class{getTreeItem(e){return e}getChildren(e){return e?Promise.resolve(e.children):Promise.resolve(this.getStructInConfig(a.default.getConfigPath()))}getStructInConfig(e){let t=a.default.extractDefaultThemeConfigFromFile(e),o=[];return o.push(new i("主菜单","结构",r.TreeItemCollapsibleState.Collapsed,this.analysisMenu(t.navbar),n.ThemeIcon.Folder,{command:"markdown.extension.vp.openDoc",title:"Open Document",arguments:["filePath"]})),o.push(new i("文档章节","结构",r.TreeItemCollapsibleState.Collapsed,this.analysisStruct(t.sidebar),n.ThemeIcon.Folder,{command:"markdown.extension.vp.openDoc",title:"打开文件夹",arguments:["filePath"]})),o}analysisMenu(e){let t=[];for(let o in e)t.push(new i(e[o].text,"菜单",r.TreeItemCollapsibleState.None,[],n.ThemeIcon.Folder,{command:"markdown.extension.vp.openDoc",title:"打开文件夹",arguments:["filePath"]}));return t}analysisStruct(e){let t=[];for(let o in e)if(e[o].children)t.push(new i(e[o].text,"节点",r.TreeItemCollapsibleState.Collapsed,this.analysisStruct(e[o].children),n.ThemeIcon.Folder,{command:"markdown.extension.vp.openDoc",title:"打开文件夹",arguments:["filePath"]}));else{if("string"!=typeof e[o])continue;t.push(new i(a.default.extractContent(e[o]),"文档",r.TreeItemCollapsibleState.None,[],n.ThemeIcon.File,{command:"markdown.extension.vp.openDoc",title:"打开文档",arguments:["filePath"]}))}return t}};class i extends r.TreeItem{constructor(e,t,o,r,a=n.ThemeIcon.File,i){super(e,o),this.label=e,this.type=t,this.collapsibleState=o,this.children=r,this.iconPath=a,this.command=i,this.tooltip=`${this.label}-${this.type}`,this.description=this.type}}},588:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});const fs=__webpack_require__(147),path=__webpack_require__(17),vscode_1=__webpack_require__(496);function extractDefaultThemeConfigFromFile(filePath){const fileContent=fs.readFileSync(filePath,"utf-8"),defaultThemeMatch=fileContent.match(/defaultTheme\(([\s\S]*?)\)/);if(defaultThemeMatch&&defaultThemeMatch.length>1){const defaultThemeConfigString=defaultThemeMatch[1];try{const defaultThemeConfig=eval(`(${defaultThemeConfigString})`);return defaultThemeConfig}catch(e){console.error("Failed to parse defaultTheme config:",e)}}return null}function extractContent(e){const t=e.split("/");let o="";return o=e.endsWith("/")?t[t.length-2]:e.endsWith(".md")?t[t.length-1].split(".md")[0]:t[t.length-1],o}function getCurrentDateTime(){const e=new Date,t=e.getFullYear().toString().slice(-2),o=(e.getMonth()+1).toString().padStart(2,"0");return`${e.getDate().toString().padStart(2,"0")}${o}${t}${e.getHours().toString().padStart(2,"0")}${e.getMinutes().toString().padStart(2,"0")}${e.getSeconds().toString().padStart(2,"0")}`}function ensureDirectoryExists(e){fs.existsSync(e)||(fs.mkdirSync(e,{recursive:!0}),console.log("【INFO】在 ",e," 创建目录"))}function getCurrentDocumentRelativePath(){const e=vscode_1.window.activeTextEditor;if(e){const t=e.document;if(t){const e=vscode_1.workspace.rootPath;if(e)return path.parse(path.relative(path.join(e,"/docs/section/"),t.fileName)).dir}}}function insertTextAtCursorPosition(e){const t=vscode_1.window.activeTextEditor;if(t){const o=t.selection.active;return t.edit((t=>{t.insert(o,e)})).then((e=>e))}return Promise.resolve(!1)}function executeNpmScript(e){const t=new vscode_1.Task({type:"npm",script:e},vscode_1.TaskScope.Workspace,e,"npm",new vscode_1.ShellExecution(`npm run ${e}`));vscode_1.tasks.executeTask(t)}function executeScript(e){const t=new vscode_1.Task({type:"vuepress",script:e},vscode_1.TaskScope.Workspace,"vuepress","vuepress",new vscode_1.ShellExecution(e));vscode_1.tasks.executeTask(t)}function createStatusBarItem(){const e=vscode_1.window.createStatusBarItem(vscode_1.StatusBarAlignment.Left);e.text="$(file-code) My Panel",e.show()}function getConfigPath(){const e=vscode_1.workspace.workspaceFolders;return path.join(e[0].uri.fsPath,"docs/.vuepress/config.js")}function getImgFolderPath(){const e=vscode_1.workspace.workspaceFolders;return path.join(e[0].uri.fsPath,"docs/.vuepress/public/imgs/")}exports.default={extractDefaultThemeConfigFromFile,extractContent,createStatusBarItem,executeScript,executeNpmScript,insertTextAtCursorPosition,getCurrentDocumentRelativePath,ensureDirectoryExists,getCurrentDateTime,getConfigPath,getImgFolderPath}},529:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.activate=void 0;const r=o(496),n=o(147),a=o(17),i=o(588);t.activate=function(e){e.subscriptions.push(r.commands.registerCommand("markdown.extension.vp.insertImg",(()=>{r.window.showOpenDialog({title:"选择要插入的图片文件",openLabel:"插入此图片",canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!0}).then((e=>{if(null==e)return;r.workspace.workspaceFolders;const t=r.window.activeTextEditor;let o="",s="",c="";if(!t)return void console.log("【ERROR】无法获取当前打开的文档！");let l=t.document,u="";if(l){{const e=a.basename(l.fileName);u=a.parse(e).name}o=u+"_"+i.default.getCurrentDateTime(),c=a.parse(e[0].path).ext,s=a.join(i.default.getImgFolderPath(),i.default.getCurrentDocumentRelativePath()),i.default.ensureDirectoryExists(s),n.copyFile(e[0].path,a.join(s,o+c),(e=>{e?console.error("【ERROR】权限或目录异常，无法复制文件",e):i.default.insertTextAtCursorPosition("<img :src=\"$withBase('/imgs/"+i.default.getCurrentDocumentRelativePath()+"/"+o+c+"')\" />")}))}else console.log("【ERROR】无法获取当前打开的文档！")}))})),r.commands.registerCommand("markdown.extension.vp.workstart",(()=>{i.default.executeNpmScript("start")})),r.commands.registerCommand("markdown.extension.vp.openDoc",(e=>function(e){console.log("---",e)}(e))))}},496:e=>{e.exports=require("vscode")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](o,o.exports,__webpack_require__),o.exports}var __webpack_exports__={};(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=__webpack_require__(496),o=__webpack_require__(529),r=__webpack_require__(527);e.activate=function(e){t.window.createTreeView("vuepressTree",{treeDataProvider:new r.DocTreeProvider}),function(e){o.activate(e),t.languages.setLanguageConfiguration("markdown",{wordPattern:/([*_]{1,2}|~~|`+)?[\p{Alphabetic}\p{Number}\p{Nonspacing_Mark}]+(_+[\p{Alphabetic}\p{Number}\p{Nonspacing_Mark}]+)*\1/gu})}(e)},e.deactivate=function(){}})(),module.exports=__webpack_exports__})();
//# sourceMappingURL=main.js.map